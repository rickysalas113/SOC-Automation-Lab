# SOC Automation Lab

## Objective

The objective of configuring Wazuh to send alerts to Shuffle was to enhance the automation and efficiency of security incident management. By integrating Wazuh with Shuffle, alerts generated by Wazuh are automatically forwarded to Shuffle for processing. Shuffle then triggers predefined workflows to analyze, categorize, and respond to these alerts based on specific criteria. Additionally, TheHive has been configured to receive alerts from Shuffle, further streamlining the response process and ensuring timely and effective handling of potential security threats.

### Skills Learned

-  Gained the ability to create and manage automated workflows in Shuffle, enabling efficient processing and response to security alerts.
-  Developed skills in configuring alert forwarding between Wazuh, Shuffle, and TheHive to ensure seamless communication and timely response to potential threats.
-  Improved capabilities in setting up a coordinated incident response system that leverages multiple tools to analyze, categorize, and act on security alerts.


### Tools Used

- Wazuh for generating and sending security alerts.
- Shuffle for automating workflows and processing alerts received from Wazuh.
- TheHive for receiving and managing alerts forwarded from Shuffle, enabling incident response and investigation.

## Screenshots of my work

- Here shows how my traffic will flow for this project.

  ![image](https://github.com/user-attachments/assets/3dd66ef8-bd6e-49bd-b8f1-a98794a95f36)

- First we will install Wazauh on our Ubuntu OS.
  
  ![image](https://github.com/user-attachments/assets/de282675-c67d-47b7-8bd0-97322796a7a0)

- Once Installed we should be able to reach our wazuh dashboard by visiting the public IP address of the wazuh server.

  ![image](https://github.com/user-attachments/assets/8ffdb13b-75a2-42b1-865c-fb4e1d1f27a6)

- Now in order to install TheHive onto our other Ubuntu OS we must install 4 components. First is Java second is Cassandra the thrid is ElasticSearch and finally is TheHive its self.

  ![image](https://github.com/user-attachments/assets/097dd0e1-9e76-45e7-b149-2ea4f82776ba)


  ![image](https://github.com/user-attachments/assets/8b17b61c-c12b-4598-aefc-0f078ceb4486)

  
  ![image](https://github.com/user-attachments/assets/97787763-2cd4-4a57-87df-d92c8b44ddd7)


  ![image](https://github.com/user-attachments/assets/19ad16f8-6b52-4d59-8651-604cfedb1288)

- After configuring cassandra, elastic search, and the hive, we visit the public IP address of thehive server.

  ![image](https://github.com/user-attachments/assets/32b33374-ab20-4a48-aeaa-69b3d5e0d3ce)

- We can now start to add a agent to our wazuh server, by installing wazuh onto our windows os.

  ![image](https://github.com/user-attachments/assets/4c2a0758-8c32-4457-82f3-bf65a675fe3e)

- Here I am on the windows machine configuring the ossec.conf file so it can ingest sysmon logs to our wazuh server.

  ![image](https://github.com/user-attachments/assets/7a79c90d-21c2-4ef6-bb75-7b75f194787e)

- I have downloaded mimikatz and will be using it to generate telemetry on our server.

  ![image](https://github.com/user-attachments/assets/d860fe8e-db41-4d40-a06c-c0760e0097c6)

- After some extra configuring we can see on our dashboard that there is a log generated for mimikatz.

   ![image](https://github.com/user-attachments/assets/d58b58e4-4d46-4b54-8aa3-cfcb7894bccb)
  

- Here we have created a rule so that wazuh can still send an alert for the file even if the name of the file was changed.

   ![image](https://github.com/user-attachments/assets/39718f5b-829c-4ce6-94a6-3ce3d8484e02)

- We are now buidling our workflow on shuffle. I have added webhook and will copy the URI so we can connect wazuh to Shuffle.

  ![Screenshot 2024-08-21 022805](https://github.com/user-attachments/assets/2d1768f5-3b24-4857-bd4e-134b68a7c19b)

- I am now adding the uri to our wazuh configuration so that shuffle can start to recieive the reports.

  ![Screenshot 2024-08-21 023114](https://github.com/user-attachments/assets/da3d4686-bf91-4854-bccd-0ae1251300b5)

- Now shuffle is receiving the alerts from wazuh.

   ![Screenshot 2024-08-21 023517](https://github.com/user-attachments/assets/0ecc95e9-dfd3-4825-b481-6221ce9e58ce)

- Here I have configured the workflow to part out the SHA256 hash from the malicious file.

   ![Screenshot 2024-08-21 024434](https://github.com/user-attachments/assets/b335476d-4773-448d-b865-a07894c62846)

- We can now add virus total to our workflow so it can give me the reputation of the hash and as you can see it has a reputation of 63.

   ![Screenshot 2024-08-21 025232](https://github.com/user-attachments/assets/d2f841a0-66a2-424e-80bf-b44445211f5b)

- Next we added thehive to our workflow and have configured it.

   ![image](https://github.com/user-attachments/assets/4d7eb471-1ab4-4f92-a51c-9ce8d4cda6f1)

- Thehive is now receiving the alert from shuffle.

   ![image](https://github.com/user-attachments/assets/04e385a8-6087-4653-943d-a809a8c8a4cc)

- Now we want to also receive a email, so we will drag in the email icon and type in the email of who will be receiving them.

   ![Screenshot 2024-08-22 151824](https://github.com/user-attachments/assets/c2e64c1d-a0e2-4741-96f2-c12ffc666e10)

- Here you can see we are also receiving emails now.

   ![Screenshot 2024-08-17 015721](https://github.com/user-attachments/assets/7c28ac92-9261-4646-adba-cbc8050d3771)

  
